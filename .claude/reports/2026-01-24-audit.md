# QA Audit Report

**Date:** 2026-01-24
**Type:** Manual Audit (/audit-now)

## Executive Summary

Coverage is at **3.3%** for frontend and backend tests are currently failing due to test setup issues. The main gaps are the core routes (tasks, projects, events) which have no tests at all. There's 1 moderate security vulnerability in dev dependencies (esbuild/vite) that's not a production concern but should be monitored.

## Coverage Status

| Area | Lines | Branches | Functions |
|------|-------|----------|-----------|
| Frontend | 3.3% | 18.7% | 5.0% |
| Backend | N/A* | N/A* | N/A* |

*Backend tests failing - needs test infrastructure fixes

**Current Phase:** 1 (Informational)
**Next Phase:** At 20% overall, will enable diff-coverage checks

## Security Findings

### Dependency Vulnerabilities

| Severity | Frontend | Backend |
|----------|----------|---------|
| Critical | 0 | 0 |
| High | 0 | 0 |
| Moderate | 1 (dev only) | 0 |
| Low | 0 | 0 |

**Frontend:** esbuild vulnerability in vite (dev dependency only, not shipped to production)

### Code Quality Issues

| Metric | Count | Notes |
|--------|-------|-------|
| Console.logs | 137 | In backend production code |
| TODO/FIXME | 4 | Review and create issues |

## Untested Code

### Backend Routes (25 of 27 untested)

Only **auth.js** and **notes.js** have test files (and notes tests are currently failing).

**High Priority** (core features, test first):
| Route | Why Priority |
|-------|--------------|
| tasks.js | Core feature, heavily used |
| projects.js | Core feature with sub-items |
| events.js | Calendar functionality |
| dashboard.js | Main user landing page |

**Medium Priority** (important features):
- files.js, images.js (file management)
- messages.js, notifications.js (real-time features)
- connections.js (social features)
- profile.js, settings.js (user management)

**Lower Priority** (admin/utility):
- admin.js, logs.js, analytics.js
- tags.js, filters.js, folders.js
- weather.js, savedLocations.js

### Frontend Components

Current tests cover:
- `Skeleton.jsx` - 77% lines
- `EmptyState.jsx` - 100% lines
- `ThemeToggle.jsx` - 100% lines
- `authSlice.js` - 64% lines
- `toastSlice.js` - 71% lines

**No tests for:**
- All feature pages (dashboard, tasks, notes, projects, calendar, etc.)
- Most UI components
- Custom hooks
- Contexts

## Recommendations

### This Week
1. **Fix backend tests** - Notes tests failing because note creation returns undefined
2. **Remove console.logs** - 137 in production backend code
3. **Add tasks.js tests** - Core feature, highest impact

### This Month
1. Reach 10% frontend coverage (add tests for core hooks/components)
2. Add tests for projects.js and events.js routes
3. Fix the moderate esbuild vulnerability when vite 7.x is stable

### Long Term
1. Reach 20% coverage to enable Phase 2 (new code must be tested)
2. Add E2E tests for critical user flows beyond smoke tests
3. Reduce console.logs to intentional logging only

## Action Items

- [ ] Fix backend test setup (notes.test.js failures)
- [ ] Remove unnecessary console.logs from backend
- [ ] Add auth triple tests to tasks.js
- [ ] Review 4 TODO comments and create issues if needed
- [ ] Monitor vite 7.x release for esbuild fix
